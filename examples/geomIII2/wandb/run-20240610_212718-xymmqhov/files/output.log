
Waiting for JIT...
[21:27:38 - main - INFO] -----------------------------
[21:27:38 - main - INFO] Iter:   0      Time: 18.003
[21:27:38 - main - INFO] -------------  --------------
[21:27:38 - main - INFO] p_in_loss      7.960e-01
[21:27:38 - main - INFO] p_out_loss     1.835e-02
[21:27:38 - main - INFO] rc_loss        4.346e+01
[21:27:38 - main - INFO] ru_loss        9.478e+06
[21:27:38 - main - INFO] rv_loss        7.004e+06
[21:27:38 - main - INFO] u_noslip_loss  1.007e-01
[21:27:38 - main - INFO] v_in_loss      3.733e-01
[21:27:38 - main - INFO] v_noslip_loss  8.152e-02
[21:27:38 - main - INFO] v_out_loss     1.266e-01
[21:27:38 - main - INFO] u_error        3.193e+00
[21:27:38 - main - INFO] v_error        5.255e+00
[21:27:41 - main - INFO] ----------------------------
[21:27:41 - main - INFO] Iter: 100      Time: 0.025
[21:27:41 - main - INFO] -------------  -------------
[21:27:41 - main - INFO] p_in_loss      3.519e-02
[21:27:41 - main - INFO] p_out_loss     1.696e-02
[21:27:41 - main - INFO] rc_loss        1.681e+00
[21:27:41 - main - INFO] ru_loss        2.376e+05
[21:27:41 - main - INFO] rv_loss        3.233e+04
[21:27:41 - main - INFO] u_noslip_loss  1.946e-03
[21:27:41 - main - INFO] v_in_loss      3.171e-04
[21:27:41 - main - INFO] v_noslip_loss  1.728e-03
[21:27:41 - main - INFO] v_out_loss     1.388e-04
[21:27:41 - main - INFO] u_error        1.004e+00
[21:27:41 - main - INFO] v_error        1.256e+00
[21:27:41 - main - INFO] ----------------------------
[21:27:41 - main - INFO] Iter: 200      Time: 0.023
[21:27:41 - main - INFO] -------------  -------------
[21:27:41 - main - INFO] p_in_loss      2.356e-02
[21:27:41 - main - INFO] p_out_loss     2.110e-02
[21:27:41 - main - INFO] rc_loss        8.649e-01
[21:27:41 - main - INFO] ru_loss        2.037e+05
[21:27:41 - main - INFO] rv_loss        1.789e+04
[21:27:41 - main - INFO] u_noslip_loss  9.614e-04
[21:27:41 - main - INFO] v_in_loss      1.135e-04
[21:27:41 - main - INFO] v_noslip_loss  7.785e-04
[21:27:41 - main - INFO] v_out_loss     8.567e-05
[21:27:41 - main - INFO] u_error        9.620e-01
[21:27:41 - main - INFO] v_error        1.142e+00
[21:27:42 - main - INFO] ----------------------------
[21:27:42 - main - INFO] Iter: 300      Time: 0.022
[21:27:42 - main - INFO] -------------  -------------
[21:27:42 - main - INFO] p_in_loss      2.245e-02
[21:27:42 - main - INFO] p_out_loss     2.327e-02
[21:27:42 - main - INFO] rc_loss        5.028e-01
[21:27:42 - main - INFO] ru_loss        1.942e+05
[21:27:42 - main - INFO] rv_loss        1.623e+04
[21:27:42 - main - INFO] u_noslip_loss  7.662e-04
[21:27:42 - main - INFO] v_in_loss      6.440e-05
[21:27:42 - main - INFO] v_noslip_loss  4.959e-04
[21:27:42 - main - INFO] v_out_loss     5.781e-05
[21:27:42 - main - INFO] u_error        9.414e-01
[21:27:42 - main - INFO] v_error        1.095e+00
[21:27:43 - main - INFO] ----------------------------
[21:27:43 - main - INFO] Iter: 400      Time: 0.023
[21:27:43 - main - INFO] -------------  -------------
[21:27:43 - main - INFO] p_in_loss      2.335e-02
[21:27:43 - main - INFO] p_out_loss     1.960e-02
[21:27:43 - main - INFO] rc_loss        4.328e-01
[21:27:43 - main - INFO] ru_loss        1.903e+05
[21:27:43 - main - INFO] rv_loss        1.687e+04
[21:27:43 - main - INFO] u_noslip_loss  7.341e-04
[21:27:43 - main - INFO] v_in_loss      3.884e-05
[21:27:43 - main - INFO] v_noslip_loss  3.783e-04
[21:27:43 - main - INFO] v_out_loss     4.626e-05
[21:27:43 - main - INFO] u_error        9.186e-01
[21:27:43 - main - INFO] v_error        1.058e+00
[21:27:44 - main - INFO] ----------------------------
[21:27:44 - main - INFO] Iter: 500      Time: 0.020
[21:27:44 - main - INFO] -------------  -------------
[21:27:44 - main - INFO] p_in_loss      2.058e-02
[21:27:44 - main - INFO] p_out_loss     2.046e-02
[21:27:44 - main - INFO] rc_loss        3.632e-01
[21:27:44 - main - INFO] ru_loss        1.929e+05
[21:27:44 - main - INFO] rv_loss        1.469e+04
[21:27:44 - main - INFO] u_noslip_loss  7.852e-04
[21:27:44 - main - INFO] v_in_loss      3.304e-05
[21:27:44 - main - INFO] v_noslip_loss  3.333e-04
[21:27:44 - main - INFO] v_out_loss     3.864e-05
[21:27:44 - main - INFO] u_error        9.003e-01
[21:27:44 - main - INFO] v_error        1.040e+00
[21:27:45 - main - INFO] ----------------------------
[21:27:45 - main - INFO] Iter: 600      Time: 0.021
[21:27:45 - main - INFO] -------------  -------------
[21:27:45 - main - INFO] p_in_loss      2.247e-02
[21:27:45 - main - INFO] p_out_loss     1.730e-02
[21:27:45 - main - INFO] rc_loss        3.614e-01
[21:27:45 - main - INFO] ru_loss        1.908e+05
[21:27:45 - main - INFO] rv_loss        1.679e+04
[21:27:45 - main - INFO] u_noslip_loss  9.435e-04
[21:27:45 - main - INFO] v_in_loss      2.830e-05
[21:27:45 - main - INFO] v_noslip_loss  3.243e-04
[21:27:45 - main - INFO] v_out_loss     3.371e-05
[21:27:45 - main - INFO] u_error        8.804e-01
[21:27:45 - main - INFO] v_error        1.016e+00
[21:27:46 - main - INFO] ----------------------------
[21:27:46 - main - INFO] Iter: 700      Time: 0.021
[21:27:46 - main - INFO] -------------  -------------
[21:27:46 - main - INFO] p_in_loss      1.945e-02
[21:27:46 - main - INFO] p_out_loss     1.823e-02
[21:27:46 - main - INFO] rc_loss        3.629e-01
[21:27:46 - main - INFO] ru_loss        1.756e+05
[21:27:46 - main - INFO] rv_loss        1.233e+04
[21:27:46 - main - INFO] u_noslip_loss  1.161e-03
[21:27:46 - main - INFO] v_in_loss      3.245e-05
[21:27:46 - main - INFO] v_noslip_loss  3.490e-04
[21:27:46 - main - INFO] v_out_loss     3.533e-05
[21:27:46 - main - INFO] u_error        8.620e-01
[21:27:46 - main - INFO] v_error        1.001e+00
[21:27:47 - main - INFO] ----------------------------
[21:27:47 - main - INFO] Iter: 800      Time: 0.020
[21:27:47 - main - INFO] -------------  -------------
[21:27:47 - main - INFO] p_in_loss      1.733e-02
[21:27:47 - main - INFO] p_out_loss     1.760e-02
[21:27:47 - main - INFO] rc_loss        3.896e-01
[21:27:47 - main - INFO] ru_loss        1.744e+05
[21:27:47 - main - INFO] rv_loss        1.527e+04
[21:27:47 - main - INFO] u_noslip_loss  1.430e-03
[21:27:47 - main - INFO] v_in_loss      3.329e-05
[21:27:47 - main - INFO] v_noslip_loss  3.805e-04
[21:27:47 - main - INFO] v_out_loss     3.638e-05
[21:27:47 - main - INFO] u_error        8.441e-01
[21:27:47 - main - INFO] v_error        9.867e-01
[21:27:47 - main - INFO] ----------------------------
[21:27:47 - main - INFO] Iter: 900      Time: 0.022
[21:27:47 - main - INFO] -------------  -------------
[21:27:47 - main - INFO] p_in_loss      1.937e-02
[21:27:47 - main - INFO] p_out_loss     1.555e-02
[21:27:47 - main - INFO] rc_loss        4.032e-01
[21:27:47 - main - INFO] ru_loss        1.643e+05
[21:27:47 - main - INFO] rv_loss        1.506e+04
[21:27:47 - main - INFO] u_noslip_loss  1.823e-03
[21:27:47 - main - INFO] v_in_loss      3.661e-05
[21:27:47 - main - INFO] v_noslip_loss  4.402e-04
[21:27:47 - main - INFO] v_out_loss     4.178e-05
[21:27:47 - main - INFO] u_error        8.254e-01
[21:27:47 - main - INFO] v_error        9.726e-01
Traceback (most recent call last):
  File "/home/pedro/PINN/jaxpi/examples/geomIII2/main.py", line 39, in <module>
    app.run(main)
  File "/usr/local/lib/python3.11/dist-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.11/dist-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
             ^^^^^^^^^^
  File "/home/pedro/PINN/jaxpi/examples/geomIII2/main.py", line 31, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
  File "/home/pedro/PINN/jaxpi/examples/geomIII2/train.py", line 114, in train_and_evaluate
    model.state = model.update_weights(model.state, batch)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/api.py", line 1786, in cache_miss
    execute = pxla.xla_pmap_impl_lazy(fun_, *tracers, **params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/pxla.py", line 288, in xla_pmap_impl_lazy
    compiled_fun, fingerprint = parallel_callable(
                                ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/linear_util.py", line 350, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/pxla.py", line 572, in parallel_callable
    pmap_computation = lower_parallel_callable(
                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/profiler.py", line 335, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/pxla.py", line 787, in lower_parallel_callable
    lowering_result = mlir.lower_jaxpr_to_module(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 969, in lower_jaxpr_to_module
    lower_jaxpr_to_fun(
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1431, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
                           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1615, in jaxpr_subcomp
    ans = lower_per_platform(rule_ctx, str(eqn.primitive),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1723, in lower_per_platform
    return kept_rules[0](ctx, *rule_args, **rule_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1662, in _pjit_lowering
    func = _pjit_cached_lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1646, in _pjit_cached_lower_jaxpr_to_fun
    func = mlir.lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1431, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
                           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1615, in jaxpr_subcomp
    ans = lower_per_platform(rule_ctx, str(eqn.primitive),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1723, in lower_per_platform
    return kept_rules[0](ctx, *rule_args, **rule_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1662, in _pjit_lowering
    func = _pjit_cached_lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1646, in _pjit_cached_lower_jaxpr_to_fun
    func = mlir.lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1431, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
                           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1615, in jaxpr_subcomp
    ans = lower_per_platform(rule_ctx, str(eqn.primitive),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1723, in lower_per_platform
    return kept_rules[0](ctx, *rule_args, **rule_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1662, in _pjit_lowering
    func = _pjit_cached_lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1646, in _pjit_cached_lower_jaxpr_to_fun
    func = mlir.lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1431, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
                           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1615, in jaxpr_subcomp
    ans = lower_per_platform(rule_ctx, str(eqn.primitive),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1723, in lower_per_platform
    return kept_rules[0](ctx, *rule_args, **rule_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1662, in _pjit_lowering
    func = _pjit_cached_lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/pjit.py", line 1646, in _pjit_cached_lower_jaxpr_to_fun
    func = mlir.lower_jaxpr_to_fun(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1431, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
                           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/jax/_src/interpreters/mlir.py", line 1614, in jaxpr_subcomp
    rule_inputs = map(_unwrap_singleton_ir_values, in_nodes)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt