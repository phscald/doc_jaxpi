
Waiting for JIT...
[12:54:22 - main - INFO] ----------------------------
[12:54:22 - main - INFO] Iter:   0      Time: 9.707
[12:54:22 - main - INFO] -------------  -------------
[12:54:22 - main - INFO] p_in_loss      6.706e-01
[12:54:22 - main - INFO] p_out_loss     3.013e-01
[12:54:22 - main - INFO] rc_loss        4.806e+01
[12:54:22 - main - INFO] ru_loss        2.483e+02
[12:54:22 - main - INFO] rv_loss        8.814e+02
[12:54:22 - main - INFO] u_noslip_loss  1.144e-01
[12:54:22 - main - INFO] v_noslip_loss  1.681e-01
[12:54:22 - main - INFO] u_error        1.267e+00
[12:54:22 - main - INFO] v_error        5.615e+00
[12:54:23 - main - INFO] ----------------------------
[12:54:23 - main - INFO] Iter: 100      Time: 0.007
[12:54:23 - main - INFO] -------------  -------------
[12:54:23 - main - INFO] p_in_loss      5.868e-04
[12:54:23 - main - INFO] p_out_loss     3.544e-04
[12:54:23 - main - INFO] rc_loss        1.837e-01
[12:54:23 - main - INFO] ru_loss        4.906e-01
[12:54:23 - main - INFO] rv_loss        4.048e-01
[12:54:23 - main - INFO] u_noslip_loss  2.233e-04
[12:54:23 - main - INFO] v_noslip_loss  1.900e-04
[12:54:23 - main - INFO] u_error        9.154e-01
[12:54:23 - main - INFO] v_error        9.966e-01
I0515 12:54:23.479614 138920243814400 checkpoints.py:574] Saving checkpoint at step: 110
I0515 12:54:23.479852 138920243814400 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
W0515 12:54:23.479959 138920243814400 type_handlers.py:302] SaveArgs.aggregate is deprecated, please use custom TypeHandler (https://orbax.readthedocs.io/en/latest/custom_handlers.html#typehandler) or contact Orbax team to migrate before May 1st, 2024. If your Pytree has empty ([], {}, None) values then use PyTreeCheckpointHandler(..., write_tree_metadata=True, ...) or use StandardCheckpointHandler to avoid TypeHandler Registry error. Please note that PyTreeCheckpointHandler.write_tree_metadata default value is already set to True.
I0515 12:54:23.480096 138920243814400 checkpointer.py:137] Saving item to ckpt/default.pkl/checkpoint_110.
Traceback (most recent call last):
  File "/home/pedro/PINN/jaxpi/examples/geomII/main.py", line 39, in <module>
    app.run(main)
  File "/usr/local/lib/python3.11/dist-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.11/dist-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
             ^^^^^^^^^^
  File "/home/pedro/PINN/jaxpi/examples/geomII/main.py", line 31, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
  File "/home/pedro/PINN/jaxpi/examples/geomII/train.py", line 138, in train_and_evaluate
    save_checkpoint(model.state, path, keep=config.saving.num_keep_ckpts)
  File "/usr/local/lib/python3.11/dist-packages/jaxpi/utils.py", line 44, in save_checkpoint
    checkpoints.save_checkpoint(workdir, state, step=step, keep=keep)
  File "/usr/local/lib/python3.11/dist-packages/flax/training/checkpoints.py", line 697, in save_checkpoint
    orbax_checkpointer.save(
  File "/usr/local/lib/python3.11/dist-packages/orbax/checkpoint/checkpointer.py", line 156, in save
    self._handler.finalize(tmpdir)
  File "/usr/local/lib/python3.11/dist-packages/orbax/checkpoint/pytree_checkpoint_handler.py", line 1493, in finalize
    type_handlers.merge_ocdbt_per_process_files(directory)
  File "/usr/local/lib/python3.11/dist-packages/orbax/checkpoint/type_handlers.py", line 646, in merge_ocdbt_per_process_files
    parent_tspec = get_tensorstore_spec(os.fspath(directory), use_ocdbt=True)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/orbax/checkpoint/type_handlers.py", line 756, in get_tensorstore_spec
    raise ValueError(f'Checkpoint path should be absolute. Got {directory}')
ValueError: Checkpoint path should be absolute. Got ckpt/default.pkl/checkpoint_110.orbax-checkpoint-tmp-1715777663480207
-----------
default
./ckpt/default.pkl