
Waiting for JIT...
[13:56:14 - main - INFO] ----------------------------
[13:56:14 - main - INFO] Iter:   0      Time: 9.555
[13:56:14 - main - INFO] -------------  -------------
[13:56:14 - main - INFO] p_in_loss      6.705e-01
[13:56:14 - main - INFO] p_out_loss     3.013e-01
[13:56:14 - main - INFO] rc_loss        4.806e+01
[13:56:14 - main - INFO] ru_loss        2.483e+02
[13:56:14 - main - INFO] rv_loss        8.813e+02
[13:56:14 - main - INFO] u_noslip_loss  1.143e-01
[13:56:14 - main - INFO] v_noslip_loss  1.682e-01
[13:56:14 - main - INFO] u_error        1.267e+00
[13:56:14 - main - INFO] v_error        5.618e+00
[13:56:15 - main - INFO] ----------------------------
[13:56:15 - main - INFO] Iter: 100      Time: 0.007
[13:56:15 - main - INFO] -------------  -------------
[13:56:15 - main - INFO] p_in_loss      5.852e-04
[13:56:15 - main - INFO] p_out_loss     3.517e-04
[13:56:15 - main - INFO] rc_loss        1.836e-01
[13:56:15 - main - INFO] ru_loss        4.899e-01
[13:56:15 - main - INFO] rv_loss        4.042e-01
[13:56:15 - main - INFO] u_noslip_loss  2.246e-04
[13:56:15 - main - INFO] v_noslip_loss  1.899e-04
[13:56:15 - main - INFO] u_error        9.154e-01
[13:56:15 - main - INFO] v_error        9.958e-01
I0515 13:56:15.420521 131601304891392 checkpoints.py:574] Saving checkpoint at step: 110
I0515 13:56:15.420856 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
W0515 13:56:15.421035 131601304891392 type_handlers.py:302] SaveArgs.aggregate is deprecated, please use custom TypeHandler (https://orbax.readthedocs.io/en/latest/custom_handlers.html#typehandler) or contact Orbax team to migrate before May 1st, 2024. If your Pytree has empty ([], {}, None) values then use PyTreeCheckpointHandler(..., write_tree_metadata=True, ...) or use StandardCheckpointHandler to avoid TypeHandler Registry error. Please note that PyTreeCheckpointHandler.write_tree_metadata default value is already set to True.
I0515 13:56:15.421268 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_110.
I0515 13:56:15.439067 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_110.orbax-checkpoint-tmp-1715781375421512 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_110
I0515 13:56:15.439227 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_110`.
[13:56:15 - main - INFO] ----------------------------
[13:56:15 - main - INFO] Iter: 200      Time: 0.005
[13:56:15 - main - INFO] -------------  -------------
[13:56:15 - main - INFO] p_in_loss      2.062e-04
[13:56:15 - main - INFO] p_out_loss     1.625e-04
[13:56:15 - main - INFO] rc_loss        9.221e-02
[13:56:15 - main - INFO] ru_loss        1.968e-01
[13:56:15 - main - INFO] rv_loss        1.583e-01
[13:56:15 - main - INFO] u_noslip_loss  1.179e-04
[13:56:15 - main - INFO] v_noslip_loss  9.698e-05
[13:56:15 - main - INFO] u_error        8.713e-01
[13:56:15 - main - INFO] v_error        9.312e-01
I0515 13:56:15.625200 131601304891392 checkpoints.py:574] Saving checkpoint at step: 220
I0515 13:56:15.625336 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:15.625521 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_220.
I0515 13:56:15.630530 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_220.orbax-checkpoint-tmp-1715781375625591 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_220
I0515 13:56:15.630658 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_220`.
-----------
default
-----------
default
-----------
default
-----------
default
[13:56:15 - main - INFO] ----------------------------
[13:56:15 - main - INFO] Iter: 300      Time: 0.005
[13:56:15 - main - INFO] -------------  -------------
[13:56:15 - main - INFO] p_in_loss      1.414e-04
[13:56:15 - main - INFO] p_out_loss     9.386e-05
[13:56:15 - main - INFO] rc_loss        6.019e-02
[13:56:15 - main - INFO] ru_loss        1.264e-01
[13:56:15 - main - INFO] rv_loss        8.073e-02
[13:56:15 - main - INFO] u_noslip_loss  9.017e-05
[13:56:15 - main - INFO] v_noslip_loss  7.711e-05
[13:56:15 - main - INFO] u_error        8.456e-01
[13:56:15 - main - INFO] v_error        8.908e-01
I0515 13:56:15.812147 131601304891392 checkpoints.py:574] Saving checkpoint at step: 330
I0515 13:56:15.812403 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:15.812869 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_330.
I0515 13:56:15.822170 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_330.orbax-checkpoint-tmp-1715781375813039 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_330
I0515 13:56:15.822371 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_330`.
[13:56:15 - main - INFO] ----------------------------
[13:56:15 - main - INFO] Iter: 400      Time: 0.006
[13:56:15 - main - INFO] -------------  -------------
[13:56:15 - main - INFO] p_in_loss      8.135e-05
[13:56:15 - main - INFO] p_out_loss     5.535e-05
[13:56:15 - main - INFO] rc_loss        5.108e-02
[13:56:15 - main - INFO] ru_loss        8.642e-02
[13:56:15 - main - INFO] rv_loss        5.229e-02
[13:56:15 - main - INFO] u_noslip_loss  8.017e-05
[13:56:15 - main - INFO] v_noslip_loss  7.003e-05
[13:56:15 - main - INFO] u_error        8.252e-01
[13:56:15 - main - INFO] v_error        8.630e-01
I0515 13:56:16.003736 131601304891392 checkpoints.py:574] Saving checkpoint at step: 440
I0515 13:56:16.003894 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:16.004193 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_440.
I0515 13:56:16.009182 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_440.orbax-checkpoint-tmp-1715781376004298 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_440
I0515 13:56:16.009316 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_440`.
[13:56:16 - main - INFO] ----------------------------
[13:56:16 - main - INFO] Iter: 500      Time: 0.005
[13:56:16 - main - INFO] -------------  -------------
[13:56:16 - main - INFO] p_in_loss      6.425e-05
[13:56:16 - main - INFO] p_out_loss     3.686e-05
[13:56:16 - main - INFO] rc_loss        3.474e-02
[13:56:16 - main - INFO] ru_loss        5.664e-02
[13:56:16 - main - INFO] rv_loss        3.779e-02
[13:56:16 - main - INFO] u_noslip_loss  7.789e-05
[13:56:16 - main - INFO] v_noslip_loss  7.197e-05
[13:56:16 - main - INFO] u_error        8.081e-01
[13:56:16 - main - INFO] v_error        8.464e-01
I0515 13:56:16.187280 131601304891392 checkpoints.py:574] Saving checkpoint at step: 550
I0515 13:56:16.187401 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:16.187572 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_550.
I0515 13:56:16.192166 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_550.orbax-checkpoint-tmp-1715781376187638 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_550
I0515 13:56:16.192278 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_550`.
[13:56:16 - main - INFO] ----------------------------
[13:56:16 - main - INFO] Iter: 600      Time: 0.006
[13:56:16 - main - INFO] -------------  -------------
[13:56:16 - main - INFO] p_in_loss      4.678e-05
[13:56:16 - main - INFO] p_out_loss     2.680e-05
[13:56:16 - main - INFO] rc_loss        2.510e-02
[13:56:16 - main - INFO] ru_loss        4.250e-02
[13:56:16 - main - INFO] rv_loss        3.099e-02
[13:56:16 - main - INFO] u_noslip_loss  8.029e-05
[13:56:16 - main - INFO] v_noslip_loss  7.460e-05
[13:56:16 - main - INFO] u_error        7.984e-01
[13:56:16 - main - INFO] v_error        8.249e-01
I0515 13:56:16.373104 131601304891392 checkpoints.py:574] Saving checkpoint at step: 660
I0515 13:56:16.373226 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:16.373413 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_660.
I0515 13:56:16.378031 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_660.orbax-checkpoint-tmp-1715781376373505 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_660
I0515 13:56:16.378134 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_660`.
[13:56:16 - main - INFO] ----------------------------
[13:56:16 - main - INFO] Iter: 700      Time: 0.005
[13:56:16 - main - INFO] -------------  -------------
[13:56:16 - main - INFO] p_in_loss      4.115e-05
[13:56:16 - main - INFO] p_out_loss     1.974e-05
[13:56:16 - main - INFO] rc_loss        2.428e-02
[13:56:16 - main - INFO] ru_loss        3.443e-02
[13:56:16 - main - INFO] rv_loss        2.439e-02
[13:56:16 - main - INFO] u_noslip_loss  8.059e-05
[13:56:16 - main - INFO] v_noslip_loss  7.730e-05
[13:56:16 - main - INFO] u_error        7.896e-01
[13:56:16 - main - INFO] v_error        8.142e-01
I0515 13:56:16.553814 131601304891392 checkpoints.py:574] Saving checkpoint at step: 770
I0515 13:56:16.553928 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:16.554090 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_770.
I0515 13:56:16.559054 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_770.orbax-checkpoint-tmp-1715781376554154 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_770
I0515 13:56:16.559161 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_770`.
[13:56:16 - main - INFO] ----------------------------
[13:56:16 - main - INFO] Iter: 800      Time: 0.005
[13:56:16 - main - INFO] -------------  -------------
[13:56:16 - main - INFO] p_in_loss      3.758e-05
[13:56:16 - main - INFO] p_out_loss     1.340e-05
[13:56:16 - main - INFO] rc_loss        1.896e-02
[13:56:16 - main - INFO] ru_loss        2.966e-02
[13:56:16 - main - INFO] rv_loss        1.993e-02
[13:56:16 - main - INFO] u_noslip_loss  8.717e-05
[13:56:16 - main - INFO] v_noslip_loss  7.915e-05
[13:56:16 - main - INFO] u_error        7.844e-01
[13:56:16 - main - INFO] v_error        8.088e-01
I0515 13:56:16.741965 131601304891392 checkpoints.py:574] Saving checkpoint at step: 880
I0515 13:56:16.742094 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:16.742273 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_880.
I0515 13:56:16.747225 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_880.orbax-checkpoint-tmp-1715781376742339 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_880
I0515 13:56:16.747339 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_880`.
[13:56:16 - main - INFO] ----------------------------
[13:56:16 - main - INFO] Iter: 900      Time: 0.005
[13:56:16 - main - INFO] -------------  -------------
[13:56:16 - main - INFO] p_in_loss      2.434e-05
[13:56:16 - main - INFO] p_out_loss     1.389e-05
[13:56:16 - main - INFO] rc_loss        1.736e-02
[13:56:16 - main - INFO] ru_loss        2.549e-02
[13:56:16 - main - INFO] rv_loss        1.712e-02
[13:56:16 - main - INFO] u_noslip_loss  8.447e-05
[13:56:16 - main - INFO] v_noslip_loss  7.728e-05
[13:56:16 - main - INFO] u_error        7.796e-01
[13:56:16 - main - INFO] v_error        8.000e-01
I0515 13:56:16.926415 131601304891392 checkpoints.py:574] Saving checkpoint at step: 990
I0515 13:56:16.926549 131601304891392 checkpoints.py:662] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0515 13:56:16.926725 131601304891392 checkpointer.py:137] Saving item to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_990.
I0515 13:56:16.931388 131601304891392 utils.py:560] Renaming /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_990.orbax-checkpoint-tmp-1715781376926797 to /home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_990
I0515 13:56:16.931506 131601304891392 utils.py:613] Finished saving checkpoint to `/home/pedro/PINN/jaxpi/examples/geomII/ckpt/default/checkpoint_990`.
-----------
default
-----------
default
-----------
default
-----------
default
-----------
default
[13:56:18 - main - INFO] ----------------------------
[13:56:18 - main - INFO] Iter: 1000     Time: 1.959
[13:56:18 - main - INFO] -------------  -------------
[13:56:18 - main - INFO] p_in_loss      2.478e-05
[13:56:18 - main - INFO] p_out_loss     1.241e-05
[13:56:18 - main - INFO] rc_loss        1.855e-02
[13:56:18 - main - INFO] ru_loss        2.191e-02
[13:56:18 - main - INFO] rv_loss        1.351e-02
[13:56:18 - main - INFO] u_noslip_loss  8.173e-05
[13:56:18 - main - INFO] v_noslip_loss  7.950e-05
[13:56:18 - main - INFO] u_error        7.788e-01
[13:56:18 - main - INFO] v_error        7.960e-01
Traceback (most recent call last):
  File "/home/pedro/PINN/jaxpi/examples/geomII/main.py", line 39, in <module>
    app.run(main)
  File "/usr/local/lib/python3.11/dist-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.11/dist-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
             ^^^^^^^^^^
  File "/home/pedro/PINN/jaxpi/examples/geomII/main.py", line 31, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
  File "/home/pedro/PINN/jaxpi/examples/geomII/train.py", line 109, in train_and_evaluate
    model.state = model.step(model.state, batch)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <lambda>
KeyboardInterrupt